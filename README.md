# WebSocket API

## üìà Market Assets Price API

–¶–µ REST+WebSocket API-—Å–µ—Ä–≤—ñ—Å –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è **—ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö** —Ç–∞ **—Ä–µ–∞–ª—å–Ω–∏—Ö** —Ü—ñ–Ω —Ä–∏–Ω–∫–æ–≤–∏—Ö –∞–∫—Ç–∏–≤—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `EUR/USD`, `GOOG`) –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏ **Fintacharts**.

---

## üßæ –ó–º—ñ—Å—Ç

- [–û–ø–∏—Å](#–æ–ø–∏—Å)
- [–ü–µ—Ä–µ–¥—É–º–æ–≤–∏](#–ø–µ—Ä–µ–¥—É–º–æ–≤–∏)
- [–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker](#–∑–∞–ø—É—Å–∫-—á–µ—Ä–µ–∑-docker)
- [Swagger](#swagger)
- [API –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏](#api-–µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏)
- [–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è](#–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è)
- [–ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è](#–ø—Ä–∏–∫–ª–∞–¥–∏-–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è)
- [–ó—É–ø–∏–Ω–∫–∞ —Ç–∞ –æ—á–∏—â–µ–Ω–Ω—è](#–∑—É–ø–∏–Ω–∫–∞-—Ç–∞-–æ—á–∏—â–µ–Ω–Ω—è)

---

## üìå –û–ø–∏—Å

–¶–µ–π –ø—Ä–æ—î–∫—Ç –Ω–∞–¥–∞—î API –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —Ä–∏–Ω–∫–æ–≤–∏–º–∏ –∞–∫—Ç–∏–≤–∞–º–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ WebSocket –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ –≤—ñ–¥ Fintacharts —Ç–∞ REST –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö. –û—Å–Ω–æ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ:

- üß† –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∞–∫—Ç–∏–≤—ñ–≤ —Ç–∞ —ñ—Å—Ç–æ—Ä—ñ—ó —Ü—ñ–Ω —É –±–∞–∑—ñ –¥–∞–Ω–∏—Ö **SQL Server** –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º **Entity Framework Core**.
- üåê –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è API —á–µ—Ä–µ–∑ **Swagger UI**.
- üê≥ –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **Docker** –¥–ª—è —Å–ø—Ä–æ—â–µ–Ω–Ω—è –∑–∞–ø—É—Å–∫—É —Ç–∞ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è.
- üì° –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ü—ñ–Ω –∞–∫—Ç–∏–≤—ñ–≤ —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ —á–µ—Ä–µ–∑ WebSocket-–∑‚Äô—î–¥–Ω–∞–Ω–Ω—è.

---

## üõ† –ü–µ—Ä–µ–¥—É–º–æ–≤–∏

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —É –≤–∞—Å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:

- [Docker](https://www.docker.com/get-started) (–≤–∫–ª—é—á–∞—é—á–∏ Docker Compose)
- [Git](https://git-scm.com/downloads) (–¥–ª—è –∫–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é)
- –î–æ—Å—Ç—É–ø –¥–æ Fintacharts API (—Ç–æ–∫–µ–Ω –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó)

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

### 1. –ö–ª–æ–Ω—É–≤–∞—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π

```bash
git clone https://github.com/your-repo-url.git
cd WebSocket_API
```

### 2. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —Ñ–∞–π–ª `appsettings.json` –º—ñ—Å—Ç–∏—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Ä—è–¥–æ–∫ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è Fintacharts API. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Server=db,1433;Database=FinancialInfo;User Id=sa;Password=MyStrength@ssword123;TrustServerCertificate=true"
  },
  "Fintacharts": {
    "ApiUrl": "https://platform.fintacharts.com",
    "WebSocketUrl": "wss://platform.fintacharts.com/api/streaming/ws/v1/realtime",
    "Token": "your-fintacharts-token"
  }
}
```

### 3. –ü–æ–±—É–¥—É–≤–∞—Ç–∏ —Ç–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏

```bash
docker-compose up --build -d
```

–¶—è –∫–æ–º–∞–Ω–¥–∞:
- –ë—É–¥—É—î –æ–±—Ä–∞–∑ –¥–ª—è API (`rostyslav05/websocket-api:latest`).
- –ó–∞–ø—É—Å–∫–∞—î –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä SQL Server (`mcr.microsoft.com/mssql/server:2022-latest`).
- –ù–∞–ª–∞—à—Ç–æ–≤—É—î –º–µ—Ä–µ–∂—É –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –º—ñ–∂ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏.

### 4. –î–æ—Å—Ç—É–ø –¥–æ API

API –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–µ –∑–∞ –∞–¥—Ä–µ—Å–æ—é:
üîó [http://localhost:8080](http://localhost:8080)

### 5. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞–Ω—É

–ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –ª–æ–≥–∏ –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
```bash
docker logs websocket_api-api-1
docker logs websocket_api-db-1
```

---

## üß™ Swagger

–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è API –¥–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ Swagger UI:
üîó [http://localhost:8080/swagger](http://localhost:8080/swagger)

Swagger –¥–æ–∑–≤–æ–ª—è—î —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏, –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ —ó—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.

---

## üì° API –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏

| –ú–µ—Ç–æ–¥   | –®–ª—è—Ö                              | –û–ø–∏—Å                                      |
|---------|-----------------------------------|-------------------------------------------|
| `GET`   | `/api/asset/supported`           | –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω–∏—Ö –∞–∫—Ç–∏–≤—ñ–≤      |
| `GET`   | `/api/asset/prices?assetIds=1,2` | –û—Ç—Ä–∏–º–∞—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ —Ü—ñ–Ω–∏ –¥–ª—è –≤–∫–∞–∑–∞–Ω–∏—Ö –∞–∫—Ç–∏–≤—ñ–≤ |
| `GET`   | `/api/asset/{symbol}`            | –û—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∞–∫—Ç–∏–≤ –∑–∞ —Å–∏–º–≤–æ–ª–æ–º |
| `DELETE`| `/api/asset/symbol?symbol={symbol}` | –í—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è –≤—ñ–¥ –∞–∫—Ç–∏–≤—É —Ç–∞ –≤–∏–¥–∞–ª–∏—Ç–∏ –π–æ–≥–æ |

### –ü—Ä–∏–∫–ª–∞–¥–∏ –∑–∞–ø–∏—Ç—ñ–≤

1. **–û—Ç—Ä–∏–º–∞—Ç–∏ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω–∏—Ö –∞–∫—Ç–∏–≤–∏**:
   ```bash
   curl http://localhost:8080/api/asset/supported
   ```

2. **–û—Ç—Ä–∏–º–∞—Ç–∏ —Ü—ñ–Ω–∏ –¥–ª—è –∞–∫—Ç–∏–≤—ñ–≤**:
   ```bash
   curl "http://localhost:8080/api/asset/prices?assetIds=1&assetIds=2"
   ```

3. **–û—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∞–∫—Ç–∏–≤**:
   ```bash
   curl http://localhost:8080/api/asset/EUR%2FUSD?providerName=alpaca
   ```

4. **–í–∏–¥–∞–ª–∏—Ç–∏ –∞–∫—Ç–∏–≤**:
   ```bash
   curl -X DELETE http://localhost:8080/api/asset/symbol?symbol=EUR%2FUSD
   ```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

- **–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è SQL Server —É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ Docker. –†—è–¥–æ–∫ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–∞–¥–∞—î—Ç—å—Å—è —É `appsettings.json` –∞–±–æ —á–µ—Ä–µ–∑ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ `ConnectionStrings__DefaultConnection`.
- **Fintacharts API**: –ù–∞–ª–∞—à—Ç—É–π—Ç–µ —Ç–æ–∫–µ–Ω —ñ URL —É `appsettings.json` –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ WebSocket —Ç–∞ REST API Fintacharts.
- **–õ–æ–≥—É–≤–∞–Ω–Ω—è**: –£–≤—ñ–º–∫–Ω–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ (–≤–∏–º–∫–Ω—ñ—Ç—å `EnableSensitiveDataLogging` —É –ø—Ä–æ–¥–∞–∫—à–µ–Ω—ñ).

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è `appsettings.json`

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Server=db,1433;Database=FinancialInfo;User Id=sa;Password=MyStrength@ssword123;TrustServerCertificate=true"
  },
  "Fintacharts": {
    "ApiUrl": "https://platform.fintacharts.com",
    "WebSocketUrl": "wss://platform.fintacharts.com/api/streaming/ws/v1/realtime",
    "Token": "your-fintacharts-token"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.EntityFrameworkCore": "Information"
    }
  }
}
```

---

## üìù –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### 1. –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∞–∫—Ç–∏–≤—É –∑–∞ —Å–∏–º–≤–æ–ª–æ–º

```bash
curl -X GET "http://localhost:8080/api/asset/AAPL?providerName=alpaca"
```

**–í—ñ–¥–ø–æ–≤—ñ–¥—å**:
```json
[
  {
    "instrumentId": "914f3cf3-0d91-4240-b27e-6479d88df25c",
    "provider": "alpaca",
    "symbol": "AAPL",
    "price": 150.25,
    "updatedAt": "2025-07-05T18:30:00Z",
    "change": 1.25
  }
]
```

### 2. –í–∏–¥–∞–ª–µ–Ω–Ω—è –∞–∫—Ç–∏–≤—É

```bash
curl -X DELETE "http://localhost:8080/api/asset/symbol?symbol=AAPL"
```

**–í—ñ–¥–ø–æ–≤—ñ–¥—å**:
```json
{
  "instrumentId": "914f3cf3-0d91-4240-b27e-6479d88df25c",
  "provider": "alpaca",
  "symbol": "AAPL",
  "price": 150.25,
  "updatedAt": "2025-07-05T18:30:00Z",
  "change": 1.25
}
```

### 3. WebSocket –ø—ñ–¥–ø–∏—Å–∫–∞

–ü—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞–∫—Ç–∏–≤—É —á–µ—Ä–µ–∑ `GET /api/asset/{symbol}`, —Å–µ—Ä–≤—ñ—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—ñ–¥–ø–∏—Å—É—î—Ç—å—Å—è –Ω–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ü—ñ–Ω —á–µ—Ä–µ–∑ WebSocket. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è:

```bash
docker logs websocket_api-api-1
```

–û—á—ñ–∫—É–≤–∞–Ω–∏–π –ª–æ–≥:
```
info: WebSocket_API.Services.WebSocket.WebSocketClientService[0]
      WebSocket connected to wss://platform.fintacharts.com/...
info: WebSocket_API.Services.WebSocket.WebSocketSubscriptionService[0]
      Sent subscription request for InstrumentId: 914f3cf3-0d91-4240-b27e-6479d88df25c, Provider: alpaca
```

---

## üõë –ó—É–ø–∏–Ω–∫–∞ —Ç–∞ –æ—á–∏—â–µ–Ω–Ω—è

1. –ó—É–ø–∏–Ω–∏—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏:
   ```bash
   docker-compose down
   ```

2. –í–∏–¥–∞–ª–∏—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏, –æ–±—Ä–∞–∑–∏ —Ç–∞ —Ç–æ–º–∏ (–¥–ª—è –ø–æ–≤–Ω–æ–≥–æ –æ—á–∏—â–µ–Ω–Ω—è):
   ```bash
   docker-compose down -v --rmi all
   ```

**–ü—Ä–∏–º—ñ—Ç–∫–∞**: –í–∏–¥–∞–ª–µ–Ω–Ω—è —Ç–æ–º—ñ–≤ (`-v`) –∑–Ω–∏—â–∏—Ç—å –¥–∞–Ω—ñ –≤ –±–∞–∑—ñ SQL Server. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∑ –æ–±–µ—Ä–µ–∂–Ω—ñ—Å—Ç—é.

---

## üìö –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

- **.NET 9.0** ‚Äì –û—Å–Ω–æ–≤–∞ –¥–ª—è API
- **Entity Framework Core** ‚Äì –î–ª—è —Ä–æ–±–æ—Ç–∏ –∑ SQL Server
- **Microsoft SQL Server** ‚Äì –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö
- **Fintacharts API** ‚Äì –î–∂–µ—Ä–µ–ª–æ –¥–∞–Ω–∏—Ö –ø—Ä–æ —Ü—ñ–Ω–∏
- **Swagger** ‚Äì –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è API
- **Docker** ‚Äì –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—è

---

## üõ† –í–∏—Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

- **–ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö**:
  - –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ SQL Server:
    ```bash
    docker logs websocket_api-db-1
    ```
  - –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –ø–∞—Ä–æ–ª—å `sa` –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –≤–∏–º–æ–≥–∞–º SQL Server (–º—ñ–Ω. 8 —Å–∏–º–≤–æ–ª—ñ–≤, –≤–∫–ª—é—á–∞—é—á–∏ –≤–µ–ª–∏–∫—ñ/–º–∞–ª—ñ –ª—ñ—Ç–µ—Ä–∏, —Ü–∏—Ñ—Ä–∏, —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ —Å–∏–º–≤–æ–ª–∏).
  - –î–æ—á–µ–∫–∞–π—Ç–µ—Å—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó SQL Server (–º–æ–∂–µ –∑–∞–π–Ω—è—Ç–∏ –¥–æ 30 —Å–µ–∫—É–Ω–¥).

- **–ü–æ–º–∏–ª–∫–∞ WebSocket**:
  - –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ç–æ–∫–µ–Ω Fintacharts —É `appsettings.json`.
  - –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ `InstrumentId` —ñ `Provider` –∫–æ—Ä–µ–∫—Ç–Ω—ñ (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é Fintacharts).

- **–î–∞–Ω—ñ –Ω–µ –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è**:
  - –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ WebSocket:
    ```bash
    docker logs websocket_api-api-1
    ```
  - –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ WebSocket-–∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–µ —Ç–∞ –Ω–∞–¥—Ö–æ–¥—è—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–∏–ø—É `l1-update`.

---
